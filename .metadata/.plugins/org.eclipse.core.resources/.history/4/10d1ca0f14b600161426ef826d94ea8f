import java.sql.*;


public class Statements {

	public static void query(String Username, String Password, String ConnString, String Driver) {
		
		Connection conn;
		Statement stmt;
		ResultSet rs;
		try{
			Class.forName(Driver);
			
			conn = DriverManager.getConnection(ConnString, Username, Password);
			stmt = conn.createStatement();
			
			//select authors and order by author's last name and first name
			rs = stmt.executeQuery(SelectAuthors());
			
			System.out.println();
			System.out.println("Select all authors from authors table and order by last and first name");
			
			while(rs.next()) {
				int authorId = rs.getInt("authorId");
				String firstName = rs.getString("firstName");
				String lastName = rs.getString("lastName");
				System.out.println("authorID: " + authorId + " firstName: " + firstName + " lastName: " + lastName);
			}
			
			System.out.println();
			
			
			
			//select all publishers from the publishers table
			rs = stmt.executeQuery(SelectPublishers());
			System.out.println("Select all publishers from publishers table");
			
			while(rs.next()) {
				int publisherID = rs.getInt("publisherID");
				String publisherName = rs.getString("publisherName");
				System.out.println("publisherID: " + publisherID + " publisherName: " + publisherName);
			}
			System.out.println();
			
			
			rs.close();
			stmt.close();
			conn.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	//Select all authors from the authors table and order information
	//alphabetically by the author's last name and first name
	private static String SelectAuthors() {
		return "SELECT * " +
				"FROM authors " +
				"ORDER BY lastName, firstName DESC";
	}

	//Select all publishers from the publishers table
	private static String SelectPublishers() {
		return "SELECT * " +
				"FROM publishers";
	}
}
